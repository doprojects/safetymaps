<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Safety Maps: A Do Project</title>
        <link rel="stylesheet" type="text/css" href="style.css" />
        <script type="text/javascript" src="jquery.min.js"></script>
        <script type="text/javascript" src="modestmaps.js"></script>
        <script type="text/javascript" src="cloudmade.js"></script>
        <script type="text/javascript" src="markerclip.js"></script>
        <script type="text/javascript" src="bbox.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                // make a map!
                var mm = com.modestmaps;
                //var template = 'http://{S}tile.openstreetmap.org/{Z}/{X}/{Y}.png';
                //var domains = [ '', 'a.', 'b.', 'c.' ];
                //var osm = new mm.TemplatedMapProvider(template, domains);
                var cm = new mm.CloudMadeProvider('1a914755a77758e49e19a26e799268b7','22677');

                var previewmap = new mm.Map('previewmap', cm);
                previewmap.setCenterZoom(new mm.Location(40.7143528, -74.0059731), 13);

                var bboxmap = new mm.Map('bboxmap', cm);
                bboxmap.setCenterZoom(new mm.Location(40.7143528, -74.0059731), 13);
                var bbox = new BoundingBox(bboxmap);
                bbox.onchange = function(nwse /* Array */) {
                    $('input[name=bbox]').attr('value', nwse.map(function(n){return n.toFixed(6)}).join(','));
                    if (nwse[0]-nwse[2] > 0.001 && nwse[3]-nwse[1] > 0.001) {
                        var nw = new mm.Location(nwse[0],nwse[1]);
                        var se = new mm.Location(nwse[2],nwse[3]);
                        previewmap.setExtent([nw,se]);
                    }
                };
                function onMapChange() {
                    bbox.updateInfo();
                }
                bboxmap.addCallback('panned', onMapChange);
                bboxmap.addCallback('resized', onMapChange);
                bboxmap.addCallback('zoomed', onMapChange);
                bboxmap.addCallback('extentset', onMapChange);
                bboxmap.addCallback('centered', onMapChange);                
            });
        </script>        
    </head>
    <body>
        <div id="header">
            <h1>Safety Maps</h1>
            <h2>
                Where will you meet your loved ones in<br>
                the event of a natural disaster or other<br>
                emergency?
            </h2>
            <img src="logo.png" alt="Safety Maps Logo">
            <div id="about">
                <p>
                    What happens when disaster strikes?<br>
                    You're separated from those you care about.<br>
                    Your phone doesn't work anymore...<br>
                    Where do you think it's a safe place to gather?<br>
                    Use Safety Maps to choose and share safe<br>
                    meeting points with your familiy and friends.
                </p>
                <p>
                    <a href="#create-your-map">Click here to start a scenario.</a>
                </p>
            </div>
            <div id="nav">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="create_your_meeting_point_map.html" class="current">Create your meeting point map</a></li>
                    <li><a href="#meeting-points">See meeting points other people have chosen</a></li>
                    <li><a href="#scenarios">View disaster scenarios</a></li>
                </ul>
            </div>
        </div>
        <div id="main">
        
            <div id="progress">
                <span class="on">1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
            </div>
        
            <div id="create">
                <form method="GET">
                    <input type="hidden" name="step" value="1"></input>
                    <p>
                        <label for="name">What's your name?</label><br>
                        <input type="text" name="name"></input>
                    </p>
                    <p>
                        <label for="forname1">Who's this map for?</label><br>
                        <input type="text" name="forname1"></input><input type="text" name="foremail1"></input><br>
                        <input type="text" name="forname2"></input><input type="text" name="foremail2"></input>
                        <!-- TODO: any number of for emails... ajaxy... how to encode? -->
                    </p>
                    <p>
                        <label for="emergency">What kind of emergency is this map for?</label><br>
                        <select name="emergency">
                            <option>Blackout</option>
                            <option>Drought</option>
                            <option>Earthquake</option>
                            <option>Fire</option>
                            <option>Flood</option>
                            <option>Public transportation failure</option>
                            <option>War</option>
                            <option>Other (please specify)</option><!-- TODO, how to specify? -->
                        </select>
                    </p>
                    <p>
                        <label for="title">What would you like to call this meeting place?<br>(You can call it anything you want)</label><br>
                        <input type="text" name="title"></input>
                    </p>                    
                    <p>
                        <button type="submit">Next</button>
                    </p>
                </form>
                
                <form method="GET">
                    <input type="hidden" name="step" value="2"></input>                
                    <p>
                        <label for="name">If you like, you can include a personal note for</label><br>
                        <input type="text" name="name"></input><br>
                        <textarea type="text" name="note"></textarea>
                    </p>                    
                    <p>
                        <button>Go back</button><button type="submit">Next</button>
                    </p>
                </form>

                <form method="GET">
                    <input type="hidden" name="step" value="3"></input>                
                    <p>
                        <label for="name">Please choose your meeting place on the map</label><br>
                        <input type="hidden" name="bbox" value="s,w,n,e"></input><br>
                    </p>                    
                    <div id="bboxmap">
                        [map here]
                        <!-- TODO: init map -->
                    </div>
                    <p>
                        <button>Go back</button><button type="submit">Select</button>
                    </p>                    
                </form>
                
                <!-- TODO preview the selected region before going on to step 4 -->
                
                <form method="GET">
                    <input type="hidden" name="step" value="4"></input>                
                    <p>
                        <label for="name">Preview</label><br>
                    </p>                    
                    <div id="previewmap">
                        [preview goes here]                    
                    </div>
                    <p>
                        <button>Go back</button><button type="submit">Next</button>
                    </p>
                </form>                

                <form method="GET">
                    <input type="hidden" name="step" value="5"></input>
                    <p>
                        <label>Map ready!</label>
                    </p>
                    <p>
                        <button type="submit">Send</button>
                    </p>
                    <p>
                        <button>Print</button>
                    </p>
                    <p>
                        <button>Answer a few more questions</button>
                    </p>
                    <p>
                        <button>Make another</button>
                    </p>
                </form>                
                
            </div>
        
        </div>
        <div id="footer">
            <p>&copy; 2010 Do Projects. Credits, Privacy Policy, etc.</p>
        </div>
    </body>
</html>